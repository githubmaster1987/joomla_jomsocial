$.fn.bic_calendar=function(a){var b=$.extend({},$.fn.bic_calendar.defaults,a);this.each(function(){var s;var q;var x=$('<div class="visualmesano"></div>');
var h="bic_cal_"+Math.floor(Math.random()*99999).toString(36);var e=b.events;var p;if(typeof b.dias!="undefined"){p=b.dias;}else{p=["l","m","x","j","v","s","d"];
}var m;if(typeof b.nombresMes!="undefined"){m=b.nombresMes;}else{m=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
}var g;if(typeof b.show_days!="undefined"){g=b.show_days;}else{g=true;}var d;if(typeof b.popover_options!="undefined"){d=b.popover_options;}else{d={placement:"top"};
}var v;if(typeof b.tooltip_options!="undefined"){v=b.tooltip_options;}else{v={placement:"top"};}var n;if(typeof b.req_ajax!="undefined"){n=b.req_ajax;}else{n=false;
}var u=$(this);o();function o(){q=$('<table class="diasmes table table">');r();var C=new Date();var E=u.val();if(E!=""){if(j(E)){var A=E.split("/");if(A[2].length==2){if(A[2].charAt(0)=="0"){A[2]=A[2].substring(1);
}A[2]=parseInt(A[2]);if(A[2]<50){A[2]+=2000;}}C=new Date(A[2],A[1]-1,A[0]);}}var D=C.getMonth();var G=C.getFullYear();f(D,G);var y=$('<td><a href="#" class="botonmessiguiente"><i class="icon-arrow-right" ></i></a></td>');
y.click(function(H){H.preventDefault();D=(D+1)%12;if(D==0){G++;}i(D,G);});var z=$('<td><a href="#" class="botonmesanterior"><i class="icon-arrow-left" ></i></a></td>');
z.click(function(H){H.preventDefault();D=(D-1);if(D==-1){G--;D=11;}i(D,G);});var B=$('<table class="table header"><tr></tr></table>');var F=$('<td colspan=5 class="mesyano span6"></td>');
B.append(z);B.append(F);B.append(y);F.append(x);s=$('<div class="bic_calendar" id="'+h+'" ></div>');s.prepend(B);s.append(q);u.append(s);w(D,G);}function i(y,z){q.empty();
r();f(y,z);w(y,z);}function r(){if(g!=false){var z=$('<tr class="dias_semana" >');var y="";$(p).each(function(B,A){y+="<td";if(B==0){y+=' class="primero"';
}if(B==6){y+=' class="domingo ultimo"';}y+=">"+A+"</td>";});y+="</tr>";z.append(y);q.append(z);}}function f(E,H){x.text(m[E]+" "+H);var z=1;var G=k(1,E,H);
var F=t(E,H);var B=E+1;var y="";for(var C=0;C<7;C++){if(C<G){var D="";if(C==0){D+="<tr>";}D+='<td class="diainvalido';if(C==0){D+=" primero";}D+='"></td>';
}else{var D="";if(C==0){D+="<tr>";}D+='<td id="'+h+"_"+z+"_"+B+"_"+H+'" ';if(C==0){D+=' class="primero"';}if(C==6){D+=' class="ultimo domingo"';}D+="><a>"+z+"</a></span>";
if(C==6){D+="</tr>";}z++;}y+=D;}var A=1;while(z<=F){var D="";if(A%7==1){D+="<tr>";}D+='<td id="'+h+"_"+z+"_"+B+"_"+H+'" ';if(A%7==1){D+=' class="primero"';
}if(A%7==0){D+=' class="domingo ultimo"';}D+="><a>"+z+"</a></td>";if(A%7==0){D+="</tr>";}z++;A++;y+=D;}A--;if(A%7!=0){D="";for(var C=(A%7)+1;C<=7;C++){var D="";
D+='<td class="diainvalido';if(C==7){D+=" ultimo";}D+='"></td>';if(C==7){D+="</tr>";}y+=D;}}q.append(y);}function k(C,y,z){var A=new Date(z,y,C);var B=A.getDay();
if(B==0){B=6;}else{B--;}return B;}function c(z,A,B){return z>0&&z<13&&B>0&&B<32768&&A>0&&A<=(new Date(B,z,0)).getDate();}function t(y,z){var A=28;while(c(y+1,A+1,z)){A++;
}return A;}function j(z){var y=z.split("/");if(y.length!=3){return false;}return c(y[1],y[0],y[2]);}function w(y,z){if(n!=false){if(n.type=="data"){e=[];
var A=JSON.parse(n.data);$.each(A,function(C,B){e.push(A[C]);});l(y,z);}else{$.ajax({type:n.type,url:n.url,data:{mes:y+1,ano:z},dataType:"json"}).done(function(B){e=[];
$.each(B,function(D,C){e.push(B[D]);});l(y,z);});}}else{l(y,z);}}function l(y,B){var A=y+1;for(var z=0;z<e.length;z++){if(e[z][0].split("/")[1]==A&&e[z][0].split("/")[2]==B){$("#"+h+"_"+e[z][0].replace(/\//g,"_")).addClass("event");
$("#"+h+"_"+e[z][0].replace(/\//g,"_")+" a").attr("data-original-title",e[z][1]);if(e[z][3]){$("#"+h+"_"+e[z][0].replace(/\//g,"_")).css("background",e[z][3]);
}if(e[z][2]==""||e[z][2]=="#"){if(e[z][4]!=""){$("#"+h+"_"+e[z][0].replace(/\//g,"_")+" a").attr("data-trigger","manual");$("#"+h+"_"+e[z][0].replace(/\//g,"_")+" a").addClass("manual_popover");
}else{$("#"+h+"_"+e[z][0].replace(/\//g,"_")+" a").attr("href","javascript:void(0);");}}else{$("#"+h+"_"+e[z][0].replace(/\//g,"_")+" a").attr("href",e[z][2]);
}if(e[z][4]){$("#"+h+"_"+e[z][0].replace(/\//g,"_")).addClass("event_popover");$("#"+h+"_"+e[z][0].replace(/\//g,"_")+" a").attr("rel","popover");$("#"+h+"_"+e[z][0].replace(/\//g,"_")+" a").attr("data-content",e[z][4]);
}else{$("#"+h+"_"+e[z][0].replace(/\//g,"_")).addClass("event_tooltip");$("#"+h+"_"+e[z][0].replace(/\//g,"_")+" a").attr("rel","tooltip");}}}$("#"+h+" .event_tooltip a").tooltip(v);
$("#"+h+" .event_popover a").popover(d);$(".manual_popover").click(function(){$(this).popover("toggle");});}});return this;};